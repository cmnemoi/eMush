#!/bin/sh

if git diff --name-only --cached | grep -E '\.php$'; then
    echo 'Running php-cs-fixer, Psalm, and PHPMD'
    docker compose -f docker/docker-compose.yml exec -T -u dev mush_php php vendor/bin/php-cs-fixer check
    docker compose -f docker/docker-compose.yml exec -T -u dev mush_php php vendor/bin/psalm
    docker compose -f docker/docker-compose.yml exec -T -u dev mush_php php vendor/bin/phpmd src text phpmd.xml --exclude src/*/DataFixtures/*,src/*/ConfigData/* --ignore-errors-on-exit
fi;
if git diff --name-only --cached | grep -E '\.(vue|js|ts|scss|css)$'; then
    echo 'Running eslint'
    docker compose -f docker/docker-compose.yml exec -T -u node mush_front yarn lint --no-fix
fi